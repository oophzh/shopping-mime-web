"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","bootsnav","common","bootstrapPaginator"],function(t,e,i,a,r,n,o){function s(){}function l(){if(n.util.menu&&n.util.menu.length>0){var e=n.util.getAdvSource().u;e||(e=n.util.getQueryString("u"));var i="";e&&(i="?u="+e);for(var a=n.util.menu.reverse(),r="<li><a id='breadcrumb_home' href='/'>"+t.i18n.map.Home+"</a></li>",o=0;o<a.length;o++){var s=a[o].menu_name+"-l-"+n.util.encodeMenuType(a[o].menu_type)+"-"+n.util.encodeMenuType(n.util.getUvid())+".html"+i;o==a.length-1?(r=r+"<li class='active'><a href='"+s+"'>"+a[o].menu_name+"</a></li>",t("#product_classify_name").html(a[o].menu_name),document.title=a[o].menu_name):r=r+"<li><a href='"+s+"'>"+a[o].menu_name+"</a></li>"}t(".breadcrumb").html(r)}}function u(){t("#list_loading").removeClass("hide"),n.dao.categoryProducts({productType:_,currentPage:g.curPage,orderby:m,currencyId:n.util.getLocalCurrency()},function(e){if(e.page){g.amount=e.page.amount,g.pageSize=e.page.pageSize;var i=(g.curPage-1)*g.pageSize+1,a=g.curPage*g.pageSize;a>g.amount&&(a=g.amount),t("#current_product_number").html(i+"-"+a),t("#product_total_number").html(g.amount)}else t("#current_product_number").html("0-0"),t("#product_total_number").html(0);var r=e.products;if(r&&r.length>0?(c(r),d(r),1==g.curPage&&p(),t("#item_list").show(),t(".empty-data").hide()):(t("#item_list").hide(),t(".empty-data").show()),t(".sort-wrap").removeClass("invisibility"),sessionStorage.menus){var o=JSON.parse(sessionStorage.menus);if(o){t("#classify_list_wrap").html(t("#classifyListTempl").tmpl(o)),t("#classify_list_wrap a").each(function(){var e=n.util.getAdvSource().u,i=t(this).attr("href");if(i&&i.indexOf("-l-")>-1){var a=n.util.getListParams(i),r=a[a.length-2];r=n.util.encodeMenuType(r);var o=n.util.encodeMenuType(n.util.getUvid());e||(e=n.util.getQueryString("u"));var s="";e&&(s="?u="+e);var l=i.substring(0,i.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+r+"-"+o+".html"+s;i=u,t(this).attr("href",u)}});for(var s=t("#classify_list_wrap span"),l=0;l<s.length;l++){s[l].id==_?t(s[l]).addClass("selected"):t(s[l]).removeClass("selected");for(var u=0;u<n.util.menu.length;u++)if(s[l].id==n.util.menu[u].menu_type){"classify_list_wrap"!==t(s[l]).parent().parent().parent().parent()[0].id&&"div"!==t(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(t(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),t(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),t(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}t("#classify_list_wrap #arrow_icon").bind("click",function(){t(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(t(this).parent().parent().parent().find("ul:first").removeClass("hide"),t(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(t(this).parent().parent().parent().find("ul:first").addClass("hide"),t(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))})}}t(".loading-mask").addClass("hide"),t(".main-wrap").removeClass("invisibility"),t("footer").removeClass("invisibility")},null,function(){t(".loading-mask").addClass("hide"),t(".main-wrap").removeClass("invisibility"),t("footer").removeClass("invisibility"),t("#list_loading").addClass("hide")})}function c(e){var i=n.util.getCurrencySymbol(n.util.getLocalCurrency()),a=n.util.getAdvSource().u;a||(a=n.util.getQueryString("u"));var r=n.util.encodeMenuType(n.util.getUvid()),o="";a&&(o="?u="+a);for(var l=0;l<e.length;l++){for(var u=e[l],c=0;c<u.display_data.length;c++){var p=u.display_data[c];p.original_price=n.util.formatProductPrice(p.original_price,i),p.current_price=n.util.formatProductPrice(p.current_price,i),p.img_display=n.util.picUrl+p.img_display,p.color_img=n.util.picUrl+p.color_img,p.height=n.util.getImageHeight(),p.href=n.util.formatProductName(u.product_name)+"-d-"+n.util.encodeMenuType(u.product_id)+"-"+n.util.encodeMenuType(p.color_id)+"-"+r+".html"+o}u.showColor=sessionStorage.img_block}t("#item_list").html(t("#productItemTempl").tmpl(e)),s()}function p(){var e=0;e=g.amount%g.pageSize==0?g.amount/g.pageSize:g.amount/g.pageSize+1,t(function(){var i={bootstrapMajorVersion:1,currentPage:g.curPage,numberOfPages:5,totalPages:e,shouldShowPage:!0,onPageClicked:function(e,a,r,n){g.curPage!==n&&(g.curPage=n,t("html").scrollTop(0),u(),i.currentPage=n,"top_page"==e.currentTarget.id?t("#page").bootstrapPaginator(i):t("#top_page").bootstrapPaginator(i))}};t("#page").bootstrapPaginator(i),t("#top_page").bootstrapPaginator(i)})}function d(e){t("#item_list .color-wrap img").bind("click",function(i){i.stopPropagation();var a=t(this).parent().parent().parent().data().data,r=t(this).data().data,n=e[a].display_data[r];t(this).parent().parent().find("img").removeClass("selected"),t(this).addClass("selected");var o=n.href;t(this).parent().parent().parent().find("a:first").attr("href",o),t(this).parent().parent().parent().find("img:first").attr("src",n.img_display),t(this).parent().parent().parent().find(".product-name").html(n.pcName),t(this).parent().parent().parent().find(".product-ext-name").html(n.pcNameExt),t(this).parent().parent().parent().find(".price-wrap .goods-price").html(n.current_price),t(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(n.original_price)})}console.log("list.js"),n.util.getCookie("isFirst")||(n.util.setCookie("isFirst",0),t(".loading-mask").removeClass("hide")),n.initLoginStatus(),n.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home),t("#sort_method").html(t.i18n.map.SortRecommended)});var m=1,g={amount:0,curPage:1,pageSize:0},h=window.location.href,f=n.util.getListParams(h),_=n.util.decodeMenuType(f[f.length-2]);n.util.menu=[],n.util.getClassifyNames(_,function(){l(),t("#sort_method").html(t.i18n.map.SortRecommended)}),t("#sort_method").html(t.i18n.map.SortRecommended),t("#sort_list li a").bind("click",function(){t("#sort_method").html(t(this)[0].text),g.curPage=1,m=Number(t(this)[0].id),u()}),n.setCurrencyCodeCallback(function(){u(_)})});