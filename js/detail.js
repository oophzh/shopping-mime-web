"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","bootsnav","common"],function(t,i,e,r,o,a){function l(i){t("#small_image_list").length>0&&t("#small_image_list").html(t("#productSmallImage").tmpl(i)),t("#small_image_list li:first").attr("id","onlickImg"),t("#vertical img:first").attr("src",i[0].big_img),-1==C.indexOf(i[0].big_img)&&t("#imageLoading").removeClass("hide"),d()}function d(){var i=null;t(document).ready(function(){t("#imageMenu li img").bind("click",function(){"onlickImg"!=t(this).attr("id")&&(t("#midimg").attr("src",t(this).data().data),-1==C.indexOf(t(this).data().data)&&t("#imageLoading").removeClass("hide"),t("#imageMenu li").removeAttr("id"),t(this).parent().attr("id","onlickImg"))}).bind("mouseover",function(){"onlickImg"!=t(this).attr("id")&&(window.clearTimeout(i),t("#midimg").attr("src",t(this).data().data),-1==C.indexOf(t(this).data().data)&&t("#imageLoading").removeClass("hide"))}).bind("mouseout",function(){"onlickImg"!=t(this).attr("id")&&(t("#midimg").attr("src",t(this).data().data),-1==C.indexOf(t(this).data().data)&&t("#imageLoading").removeClass("hide"),t(this).removeAttr("style"),i=window.setTimeout(function(){t("#midimg").attr("src",t("#onlickImg img").data().data),-1==C.indexOf(t("#onlickImg img").data().data)&&t("#imageLoading").removeClass("hide")},1e3))})})}function n(i){1==i.length?I.productColorId=i[0].color_id:(t("#color_data_wrap").removeClass("hide"),t("#color_list").html(t("#colorItem").tmpl(i)),t(t("#color_list li")[v]).find("span").css("display","block"),t(t("#color_list li")[v]).find("img").addClass("selected-image-border"),t("#color_desc").html(i[v].color_des),I.productColorId=i[v].color_id,t("#color_list li").bind("click",function(){if("none"==t(this).find("span").css("display")){t("#color_list li").find("span").css("display","none"),t("#color_list li").find("img").removeClass("selected-image-border"),t(this).find("span").css("display","block"),t(this).find("img").addClass("selected-image-border");var e=t(this).data().data;t("#color_desc").html(i[e].color_des),t("#name").html(i[e].pcName),t("#product_ext_name").html(i[e].pcNameExt),t("#current_price").html(i[e].current_price),t("#original_price").html(i[e].original_price),I.productColorId=i[e].color_id,l(i[e].img_groups)}}))}function c(i){var e="";t("#dyn_attrs_list").html(t("#dynAttrsItem").tmpl(i));for(var r=0;r<i.length;r++){var o=i[r];t("#"+o.attr_name+"_content").html(o.domain_list[0]),o.selectedAttr=o.domain_list[0],"Size"==o.attr_name&&t("#size_guide").html(t.i18n.map.SizeGuide),e=0==r?o.attr_name+":"+o.selectedAttr:e+";"+o.attr_name+":"+o.selectedAttr}I.attrDes=e,t("#dyn_attrs_list select").each(function(){t(this).on("change",function(){var r=t(this).find("option:selected").text(),o=t(this).parent().data().data;e="";for(var a=0;a<i.length;a++){var l=i[a];a==o&&(l.selectedAttr=r),e=0==a?l.attr_name+":"+l.selectedAttr:e+";"+l.attr_name+":"+l.selectedAttr}I.attrDes=e})})}function u(){a.dao.productDetail({productId:h,currencyId:a.util.getLocalCurrency()},function(i){if(i.product_id){y=i;var e=i;I.productId=y.product_id;for(var r=a.util.getCurrencySymbol(a.util.getLocalCurrency()),o=0;o<e.color_data.length;o++){var d=e.color_data[o];d.original_price=a.util.formatProductPrice(d.original_price,r),d.current_price=a.util.formatProductPrice(d.current_price,r),d.img_display=a.util.picUrl+d.img_display,d.color_img=a.util.picUrl+d.color_img,d.width=200,d.height=200;for(var u=0;u<d.img_groups.length;u++){var g=d.img_groups[u];g.small_img=a.util.picUrl+g.small_img,g.big_img=a.util.picUrl+g.big_img}}e.product_des?t(".description").html(e.product_des):t(".description").parent().parent().hide(),document.title=e.product_name;for(var o=0;o<e.color_data.length;o++)if(f==e.color_data[o].color_id){v=o;break}if(t("#name").html(e.color_data[v].pcName),t("#product_ext_name").html(e.color_data[v].pcNameExt),t("#current_price").html(e.color_data[v].current_price),t("#original_price").html(e.color_data[v].original_price),e.advtxts&&e.advtxts.length>0){for(var _="",o=0;o<e.advtxts.length;o++)_=_+e.advtxts[o]+"<br>";t("#shipping_info").html(_),t("#shipping_info").parent().parent().show()}else t("#shipping_info").parent().parent().hide();f||(f=e.color_data[v].color_id),n(e.color_data),c(e.color_data[v].dyn_attrs),l(e.color_data[v].img_groups),p(e.product_type),a.util.menu=[],a.util.getClassifyNames(e.product_type,function(){s()}),m()}})}function s(){if(a.util.menu&&a.util.menu.length>0){var i=a.util.getAdvSource().u;i||(i=a.util.getQueryString("u"));var e="";i&&(e="?u="+i);var r=a.util.menu.reverse();r.push({menu_name:document.title});for(var o="<li><a id='breadcrumb_home' href='/'>"+t.i18n.map.Home+"</a></li>",l=0;l<r.length;l++)if(l==r.length-1);else{var d=r[l].menu_name+"-l-"+a.util.encodeMenuType(r[l].menu_type)+"-"+a.util.encodeMenuType(a.util.getUvid())+".html"+e;o=o+"<li><a href='"+d+"'>"+r[l].menu_name+"</a></li>"}t(".breadcrumb").html(o)}}function m(){var t=localStorage.currentBrowseList;t=t?JSON.parse(t):[];for(var i=0;i<t.length;i++){var e=t[i];if(e.productId===h&&e.productColorId===f){t.splice(i,1);break}}var r={productId:h,productColorId:f};t.push(r),t.length>30&&(t=t.splice(1,t.length-1)),localStorage.setItem("currentBrowseList",JSON.stringify(t))}function p(i){a.dao.productsRel({menuType:i,productId:h,productColorId:I.productColorId},function(i){var e=a.util.getAdvSource().u;e||(e=a.util.getQueryString("u"));var r="";e&&(r="?u="+e);for(var o=a.util.encodeMenuType(a.util.getUvid()),l=0;l<i.length;l++){var d=i[l];d.imgDisplay=a.util.picUrl+d.imgDisplay;var n=a.util.formatProductName(d.prdName)+"-d-"+a.util.encodeMenuType(d.productId)+"-"+a.util.encodeMenuType(d.productColorId)+"-"+o+".html"+r;d.detailUrl=n}t("#peripheral_products_list").html(t("#peripheralProductListTempl").tmpl(i))})}console.log("detail.js");var g=window.location.href,_=a.util.getDetailParams(g),h=a.util.decodeMenuType(_[_.length-3]),f=a.util.decodeMenuType(_[_.length-2]),v=0,y={},I={productId:"",productColorId:"",productNum:"",attrDes:""},C=[];a.setCurrencyCodeCallback(function(){u()}),a.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home)}),a.initLoginStatus(),function(){t("#addCartBtn").click(function(){if(console.log("addCartBtn"),0==t("#dyn_attrs_list").children().length){if(""==I.productId||""==I.productColorId||""==I.productNum)return}else if(""==I.productId||""==I.productColorId||""==I.productNum||""==I.attrDes)return;if(a.util.checkIsLogin()){I.userId=a.util.getUserId();var i=[];i.push(I),a.dao.merge2cart({inputParams:JSON.stringify(i)},function(){window.location.href="../../../shopping_cart.html"},function(t){alert(t.msg)})}else{var i=localStorage.productList;i=i?JSON.parse(i):[];for(var e=!1,r=0,o=0;o<i.length;o++){var l=i[o];I.productId==l.productId&&I.productColorId==l.productColorId&&I.attrDes==l.attrDes&&(e=!0,l.productNum=l.productNum+I.productNum),r+=l.number}e||(i.push(I),r+=I.productNum),localStorage.productList=JSON.stringify(i),t("#cart_product_number").html(r),t("#cart_product_number").show(),window.location.href="../../../shopping_cart.html"}}),t("#addWishBtn").click(function(){a.util.checkIsLogin()||(window.location.href="../../../login.html")}),t("#midimg").load(function(i){console.log("big image loading"),t("#imageLoading").addClass("hide"),C.push(i.currentTarget.currentSrc)})}(),function(){t("#qty_list option[value='1']").prop("selected","selected");var i=t("#qty_list").find("option:selected").val();I.productNum=Number(i),t("#qty_list").on("change",function(){var i=t(this).find("option:selected").text();I.productNum=Number(i)})}()});